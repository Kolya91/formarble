"use strict";angular.module("formarble/controls/tree",["formarble"]).directive("fmTree",["fm",function(e){return{templateUrl:e.urlResolver("tree"),scope:!0,controllerAs:"$tree",controller:["$scope","$element","$attrs",function(t,r,l){var i,n=t.$eval(l.fmTree||"$control");t.$isSubtree=angular.isDefined(r.parent().controller("fmTree")),t.$subControls=t.$subControls.filter(function(e){return i||(i=e),-1===n.display.tree.indexOf(e._id)}),this.selected=null,this.select=function(e){this.selected=e},this.isSelected=function(e){return e===this.selected},this.isOpen=function(t){var r=e.oget(t,"display.open");return r=r||this.selected&&this.selected.path.slice(0,t.path.length)===t.path},t.$isSubtree||t.$subControls.length||this.select(i)}]}}]).directive("fmTreeSidebar",["$compile","$templateCache",function(e,t){return{require:["^fmTree","^fmForm"],scope:!0,link:function(r,l,i,n){var s=n[0],o=n[1],c=r.$eval(i.fmTreeSidebar);c.display.tree&&(r.$items=c.display.tree.map(function(e){return c.properties[e]}).filter(angular.identity),l.html(t.get(o.getTemplateUrl("tree-sidebar"))),e(l.contents())(r)),r.$select=function(e){s.select(e)}}}}]),angular.module("formarble/controls/tree").run(["$templateCache",function(e){e.put("bs/tree-sidebar.html",'<li ng-repeat="i in $items" ng-class="{selected: $tree.isSelected(i), open: $tree.isOpen(i)}"><a href="" ng-click="$select(i)">{{i.title}}</a><ul ng-if="$tree.isOpen(i)" fm-tree-sidebar="i"></ul></li>')}]),angular.module("formarble/controls/tree").run(["$templateCache",function(e){e.put("bs/tree.html",'<h3 class="text-muted" ng-if="!$isSubtree"><a href="" ng-click="$tree.select()">{{$control.title}}</a></h3><div class="row"><div class="col-lg-3" ng-if="!$isSubtree"><ol fm-tree-sidebar="$control"></ol></div><div ng-class=" {\'col-lg-12\': $isSubtree, \'col-lg-9\': !$isSubtree}"><div ng-if="!$tree.selected && $subControls.length"><div ng-repeat="c in $subControls" fm-control="c"></div></div><div ng-if="!$tree.selected && !$subControls.length"><h3 class="text-muted">Select option in tree</h3></div><div ng-if="$tree.selected"><div fm-control="$tree.selected"></div></div></div></div>')}]);